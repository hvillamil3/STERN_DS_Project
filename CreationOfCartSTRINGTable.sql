
select  order_id,st = [1]+','+isnull([2],0)+','+isnull([3],0)+','+isnull([4],0)+','+isnull([5],0)+','+isnull([6],0)+','+isnull([7],0)+','+isnull([8],0)+','+isnull([9],0)+','+isnull([10],0)+','+isnull([11],0)+','+isnull([12],0)+','+isnull([13],0)+','+isnull([14],0)+','+isnull([15],0)+','+isnull([16],0)+','+isnull([17],0)+','+isnull([18],0)+','+isnull([19],0)+','+isnull([20],0)+','+isnull([21],0)+','+isnull([22],0)+','+isnull([23],0)+','+isnull([24],0)+','+isnull([25],0)+','+isnull([26],0)+','+isnull([27],0)+','+isnull([28],0)+','+isnull([29],0)+','+isnull([30],0)+','+isnull([31],0)+','+isnull([32],0)+','+isnull([33],0)+','+isnull([34],0)+','+isnull([35],0)+','+isnull([36],0)+','+isnull([37],0)+','+isnull([38],0)+','+isnull([39],0)+','+isnull([40],0)+','+isnull([41],0)+','+isnull([42],0)+','+isnull([43],0)+','+isnull([44],0)+','+isnull([45],0)+','+isnull([46],0)+','+isnull([47],0)+','+isnull([48],0)+','+isnull([49],0)+','+isnull([50],0)+','+isnull([51],0)+','+isnull([52],0)+','+isnull([53],0)+','+isnull([54],0)+','+isnull([55],0)+','+isnull([56],0)+','+isnull([57],0)+','+isnull([58],0)+','+isnull([59],0)+','+isnull([60],0)+','+isnull([61],0)+','+isnull([62],0)+','+isnull([63],0)+','+isnull([64],0)+','+isnull([65],0)+','+isnull([66],0)+','+isnull([67],0)+','+isnull([68],0)+','+isnull([69],0)+','+isnull([70],0)+','+isnull([71],0)+','+isnull([72],0)+','+isnull([73],0)+','+isnull([74],0)+','+isnull([75],0)+','+isnull([76],0)+','+isnull([77],0)+','+isnull([78],0)+','+isnull([79],0)+','+isnull([80],0)+','+isnull([81],0)+','+isnull([82],0)+','+isnull([83],0)+','+isnull([84],0)+','+isnull([85],0)+','+isnull([86],0)+','+isnull([87],0)+','+isnull([88],0)+','+isnull([89],0)+','+isnull([90],0)+','+isnull([91],0)+','+isnull([92],0)+','+isnull([93],0)+','+isnull([94],0)+','+isnull([95],0)+','+isnull([96],0)+','+isnull([97],0)+','+isnull([98],0)+','+isnull([99],0)+','+isnull([100],0)+','+isnull([101],0)+','+isnull([102],0)+','+isnull([103],0)+','+isnull([104],0)+','+isnull([105],0)+','+isnull([106],0)+','+isnull([107],0)+','+isnull([108],0)+','+isnull([109],0)+','+isnull([110],0)+','+isnull([111],0)+','+isnull([112],0)+','+isnull([113],0)+','+isnull([114],0)+','+isnull([115],0)+','+isnull([116],0)+','+isnull([117],0)+','+isnull([118],0)+','+isnull([119],0)+','+isnull([120],0)+','+isnull([121],0)+','+isnull([122],0)+','+isnull([123],0)+','+isnull([124],0)+','+isnull([125],0)+','+isnull([126],0)+','+isnull([127],0)+','+isnull([128],0)+','+isnull([129],0)+','+isnull([130],0)+','+isnull([131],0)+','+isnull([132],0)+','+isnull([133],0)+','+isnull([134],0)+','+isnull([135],0)+','+isnull([136],0)+','+isnull([137],0)+','+isnull([138],0)+','+isnull([139],0)+','+isnull([140],0)+','+isnull([141],0)+','+isnull([142],0)+','+isnull([143],0)+','+isnull([144],0)+','+isnull([145],0)+','+isnull([146],0)
from (
select *
from Carts_prior
) as ddd
 

 -----HERE
UPDATE Carts_prior
SET Cart_string = ddd.Cart_string
FROM (
select  order_id,Cart_string = [1]+','+isnull([2],0)+','+isnull([3],0)+','+isnull([4],0)+','+isnull([5],0)+','+isnull([6],0)+','+isnull([7],0)+','+isnull([8],0)+','+isnull([9],0)+','+isnull([10],0)+','+isnull([11],0)+','+isnull([12],0)+','+isnull([13],0)+','+isnull([14],0)+','+isnull([15],0)+','+isnull([16],0)+','+isnull([17],0)+','+isnull([18],0)+','+isnull([19],0)+','+isnull([20],0)+','+isnull([21],0)+','+isnull([22],0)+','+isnull([23],0)+','+isnull([24],0)+','+isnull([25],0)+','+isnull([26],0)+','+isnull([27],0)+','+isnull([28],0)+','+isnull([29],0)+','+isnull([30],0)+','+isnull([31],0)+','+isnull([32],0)+','+isnull([33],0)+','+isnull([34],0)+','+isnull([35],0)+','+isnull([36],0)+','+isnull([37],0)+','+isnull([38],0)+','+isnull([39],0)+','+isnull([40],0)+','+isnull([41],0)+','+isnull([42],0)+','+isnull([43],0)+','+isnull([44],0)+','+isnull([45],0)+','+isnull([46],0)+','+isnull([47],0)+','+isnull([48],0)+','+isnull([49],0)+','+isnull([50],0)+','+isnull([51],0)+','+isnull([52],0)+','+isnull([53],0)+','+isnull([54],0)+','+isnull([55],0)+','+isnull([56],0)+','+isnull([57],0)+','+isnull([58],0)+','+isnull([59],0)+','+isnull([60],0)+','+isnull([61],0)+','+isnull([62],0)+','+isnull([63],0)+','+isnull([64],0)+','+isnull([65],0)+','+isnull([66],0)+','+isnull([67],0)+','+isnull([68],0)+','+isnull([69],0)+','+isnull([70],0)+','+isnull([71],0)+','+isnull([72],0)+','+isnull([73],0)+','+isnull([74],0)+','+isnull([75],0)+','+isnull([76],0)+','+isnull([77],0)+','+isnull([78],0)+','+isnull([79],0)+','+isnull([80],0)+','+isnull([81],0)+','+isnull([82],0)+','+isnull([83],0)+','+isnull([84],0)+','+isnull([85],0)+','+isnull([86],0)+','+isnull([87],0)+','+isnull([88],0)+','+isnull([89],0)+','+isnull([90],0)+','+isnull([91],0)+','+isnull([92],0)+','+isnull([93],0)+','+isnull([94],0)+','+isnull([95],0)+','+isnull([96],0)+','+isnull([97],0)+','+isnull([98],0)+','+isnull([99],0)+','+isnull([100],0)+','+isnull([101],0)+','+isnull([102],0)+','+isnull([103],0)+','+isnull([104],0)+','+isnull([105],0)+','+isnull([106],0)+','+isnull([107],0)+','+isnull([108],0)+','+isnull([109],0)+','+isnull([110],0)+','+isnull([111],0)+','+isnull([112],0)+','+isnull([113],0)+','+isnull([114],0)+','+isnull([115],0)+','+isnull([116],0)+','+isnull([117],0)+','+isnull([118],0)+','+isnull([119],0)+','+isnull([120],0)+','+isnull([121],0)+','+isnull([122],0)+','+isnull([123],0)+','+isnull([124],0)+','+isnull([125],0)+','+isnull([126],0)+','+isnull([127],0)+','+isnull([128],0)+','+isnull([129],0)+','+isnull([130],0)+','+isnull([131],0)+','+isnull([132],0)+','+isnull([133],0)+','+isnull([134],0)+','+isnull([135],0)+','+isnull([136],0)+','+isnull([137],0)+','+isnull([138],0)+','+isnull([139],0)+','+isnull([140],0)+','+isnull([141],0)+','+isnull([142],0)+','+isnull([143],0)+','+isnull([144],0)+','+isnull([145],0)+','+isnull([146],0)
--into Cart_prior_str
from Carts_prior (nolock)
--where Cart_string is null
) as ddd
WHERE Carts_prior.order_id = ddd.order_id
-----

select  order_id,Cart_string = [1]+','+isnull([2],0)+','+isnull([3],0)+','+isnull([4],0)+','+isnull([5],0)+','+isnull([6],0)+','+isnull([7],0)+','+isnull([8],0)+','+isnull([9],0)+','+isnull([10],0)+','+isnull([11],0)+','+isnull([12],0)+','+isnull([13],0)+','+isnull([14],0)+','+isnull([15],0)+','+isnull([16],0)+','+isnull([17],0)+','+isnull([18],0)+','+isnull([19],0)+','+isnull([20],0)+','+isnull([21],0)+','+isnull([22],0)+','+isnull([23],0)+','+isnull([24],0)+','+isnull([25],0)+','+isnull([26],0)+','+isnull([27],0)+','+isnull([28],0)+','+isnull([29],0)+','+isnull([30],0)+','+isnull([31],0)+','+isnull([32],0)+','+isnull([33],0)+','+isnull([34],0)+','+isnull([35],0)+','+isnull([36],0)+','+isnull([37],0)+','+isnull([38],0)+','+isnull([39],0)+','+isnull([40],0)+','+isnull([41],0)+','+isnull([42],0)+','+isnull([43],0)+','+isnull([44],0)+','+isnull([45],0)+','+isnull([46],0)+','+isnull([47],0)+','+isnull([48],0)+','+isnull([49],0)+','+isnull([50],0)+','+isnull([51],0)+','+isnull([52],0)+','+isnull([53],0)+','+isnull([54],0)+','+isnull([55],0)+','+isnull([56],0)+','+isnull([57],0)+','+isnull([58],0)+','+isnull([59],0)+','+isnull([60],0)+','+isnull([61],0)+','+isnull([62],0)+','+isnull([63],0)+','+isnull([64],0)+','+isnull([65],0)+','+isnull([66],0)+','+isnull([67],0)+','+isnull([68],0)+','+isnull([69],0)+','+isnull([70],0)+','+isnull([71],0)+','+isnull([72],0)+','+isnull([73],0)+','+isnull([74],0)+','+isnull([75],0)+','+isnull([76],0)+','+isnull([77],0)+','+isnull([78],0)+','+isnull([79],0)+','+isnull([80],0)+','+isnull([81],0)+','+isnull([82],0)+','+isnull([83],0)+','+isnull([84],0)+','+isnull([85],0)+','+isnull([86],0)+','+isnull([87],0)+','+isnull([88],0)+','+isnull([89],0)+','+isnull([90],0)+','+isnull([91],0)+','+isnull([92],0)+','+isnull([93],0)+','+isnull([94],0)+','+isnull([95],0)+','+isnull([96],0)+','+isnull([97],0)+','+isnull([98],0)+','+isnull([99],0)+','+isnull([100],0)+','+isnull([101],0)+','+isnull([102],0)+','+isnull([103],0)+','+isnull([104],0)+','+isnull([105],0)+','+isnull([106],0)+','+isnull([107],0)+','+isnull([108],0)+','+isnull([109],0)+','+isnull([110],0)+','+isnull([111],0)+','+isnull([112],0)+','+isnull([113],0)+','+isnull([114],0)+','+isnull([115],0)+','+isnull([116],0)+','+isnull([117],0)+','+isnull([118],0)+','+isnull([119],0)+','+isnull([120],0)+','+isnull([121],0)+','+isnull([122],0)+','+isnull([123],0)+','+isnull([124],0)+','+isnull([125],0)+','+isnull([126],0)+','+isnull([127],0)+','+isnull([128],0)+','+isnull([129],0)+','+isnull([130],0)+','+isnull([131],0)+','+isnull([132],0)+','+isnull([133],0)+','+isnull([134],0)+','+isnull([135],0)+','+isnull([136],0)+','+isnull([137],0)+','+isnull([138],0)+','+isnull([139],0)+','+isnull([140],0)+','+isnull([141],0)+','+isnull([142],0)+','+isnull([143],0)+','+isnull([144],0)+','+isnull([145],0)+','+isnull([146],0)
into Cart_prior_str
from Carts_prior (nolock)
--where Cart_string is null


select *
from [dbo].[products]
where product_id =1

select Cart_string , count(*)
from Cart_prior_str
group by Cart_string
order by count(*)


select  order_id,Cart_string = [1]+','+isnull([2],0)+','+isnull([3],0)+','+isnull([4],0)+','+isnull([5],0)+','+isnull([6],0)+','+isnull([7],0)+','+isnull([8],0)+','+isnull([9],0)+','+isnull([10],0)+','+isnull([11],0)+','+isnull([12],0)+','+isnull([13],0)+','+isnull([14],0)+','+isnull([15],0)+','+isnull([16],0)+','+isnull([17],0)+','+isnull([18],0)+','+isnull([19],0)+','+isnull([20],0)+','+isnull([21],0)+','+isnull([22],0)+','+isnull([23],0)+','+isnull([24],0)+','+isnull([25],0)+','+isnull([26],0)+','+isnull([27],0)+','+isnull([28],0)+','+isnull([29],0)+','+isnull([30],0)+','+isnull([31],0)+','+isnull([32],0)+','+isnull([33],0)+','+isnull([34],0)+','+isnull([35],0)+','+isnull([36],0)+','+isnull([37],0)+','+isnull([38],0)+','+isnull([39],0)+','+isnull([40],0)+','+isnull([41],0)+','+isnull([42],0)+','+isnull([43],0)+','+isnull([44],0)+','+isnull([45],0)+','+isnull([46],0)+','+isnull([47],0)+','+isnull([48],0)+','+isnull([49],0)+','+isnull([50],0)+','+isnull([51],0)+','+isnull([52],0)+','+isnull([53],0)+','+isnull([54],0)+','+isnull([55],0)+','+isnull([56],0)+','+isnull([57],0)+','+isnull([58],0)+','+isnull([59],0)+','+isnull([60],0)+','+isnull([61],0)+','+isnull([62],0)+','+isnull([63],0)+','+isnull([64],0)+','+isnull([65],0)+','+isnull([66],0)+','+isnull([67],0)+','+isnull([68],0)+','+isnull([69],0)+','+isnull([70],0)+','+isnull([71],0)+','+isnull([72],0)+','+isnull([73],0)+','+isnull([74],0)+','+isnull([75],0)+','+isnull([76],0)+','+isnull([77],0)+','+isnull([78],0)+','+isnull([79],0)+','+isnull([80],0)+','+isnull([81],0)+','+isnull([82],0)+','+isnull([83],0)+','+isnull([84],0)+','+isnull([85],0)+','+isnull([86],0)+','+isnull([87],0)+','+isnull([88],0)+','+isnull([89],0)+','+isnull([90],0)+','+isnull([91],0)+','+isnull([92],0)+','+isnull([93],0)+','+isnull([94],0)+','+isnull([95],0)+','+isnull([96],0)+','+isnull([97],0)+','+isnull([98],0)+','+isnull([99],0)+','+isnull([100],0)+','+isnull([101],0)+','+isnull([102],0)+','+isnull([103],0)+','+isnull([104],0)+','+isnull([105],0)+','+isnull([106],0)+','+isnull([107],0)+','+isnull([108],0)+','+isnull([109],0)+','+isnull([110],0)+','+isnull([111],0)+','+isnull([112],0)+','+isnull([113],0)+','+isnull([114],0)+','+isnull([115],0)+','+isnull([116],0)+','+isnull([117],0)+','+isnull([118],0)+','+isnull([119],0)+','+isnull([120],0)+','+isnull([121],0)+','+isnull([122],0)+','+isnull([123],0)+','+isnull([124],0)+','+isnull([125],0)+','+isnull([126],0)+','+isnull([127],0)+','+isnull([128],0)+','+isnull([129],0)+','+isnull([130],0)+','+isnull([131],0)+','+isnull([132],0)+','+isnull([133],0)+','+isnull([134],0)+','+isnull([135],0)+','+isnull([136],0)+','+isnull([137],0)+','+isnull([138],0)+','+isnull([139],0)+','+isnull([140],0)+','+isnull([141],0)+','+isnull([142],0)+','+isnull([143],0)+','+isnull([144],0)+','+isnull([145],0)+','+isnull([146],0)
into Cart_prior_str
from Carts_prior (nolock)